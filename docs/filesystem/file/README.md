# $file

### About

This is the one function you can use to store files that automatically picks the right thing for you. This function is recommended for storing and reading files. Please note that all file paths should start with /a/.

### Properties

<table><thead><tr><th>Name</th><th data-type="select">Type</th><th>Description</th></tr></thead><tbody><tr><td><a href="properties/save.md">save</a></td><td></td><td>This is used to save a file on /a/.</td></tr><tr><td><a href="properties/open.md">open</a></td><td></td><td>Reads the content of a file.</td></tr><tr><td><a href="properties/copy.md">copy</a></td><td></td><td>Copies a file or folder to another location</td></tr><tr><td><a href="properties/delete.md">delete</a></td><td></td><td>Deletes a file.</td></tr><tr><td><a href="properties/download.md">download</a></td><td></td><td>Downloads a file to your actual computer</td></tr><tr><td><a href="properties/format.md">format</a></td><td></td><td>Removes all user data</td></tr><tr><td><a href="properties/move.md">move</a></td><td></td><td>Moves a file or folder to a different location</td></tr><tr><td><a href="properties/rename.md">rename</a></td><td></td><td>Changes the name of a file or folder</td></tr><tr><td><a href="properties/upload.md">upload</a></td><td></td><td>Shows browser file upload dialog</td></tr><tr><td><a href="properties/geturl.md">getUrl</a></td><td></td><td>Retrieves file data</td></tr><tr><td>iterateFolder</td><td></td><td></td></tr><tr><td>getTruePath</td><td></td><td></td></tr><tr><td>scan</td><td></td><td></td></tr><tr><td>onDrop</td><td></td><td></td></tr><tr><td>setDotFolders</td><td></td><td></td></tr></tbody></table>

### Return output

{% code title="$file" %}
```javascript
{
  "getUrl": "function(e, n, t) {\n            t || (t = $fs.utils.getInfo(e)), 0 === (e + \"\").indexOf(\"/a/\") ? p.open(e, \"Blob\", function(e) {\n                var t = window.URL.createObjectURL(e);\n                (n || $noop)(t)\n            }, t.mime) : (0 === (e + \"\").indexOf(\"c/\") && (e = \"/\" + e), (n || $noop)(e))\n        }",
  "open": "function(e, a, s) {\n            if (\"string\" != typeof e) throw new Error(\"$file.open : no path specified\");\n            var t = e,\n                l = $fs.utils.getInfo(e);\n            \"function\" != typeof a || s || (s = a, a = \"String\");\n            var n, f = \"String\";\n\n            function u(e) {\n                s.call(l, e, f)\n            }\n            0 === e.indexOf(\"/a/\") ? (t = e.replace(/^\\/a\\//, \"\"), -1 < $store.keys().indexOf(t) ? (\"Blob\" === a && (n = $fs.utils.getMime(t)), $io.String[a]($store.getRaw(t), u, n || \"text/plain\")) : $db.getRaw(t, function(e, t) {\n                f = $io.type(t), $io[f][a](t, u, l.mime)\n            })) : $ajax.get(e, {\n                arraybuffer: \"String\" !== a\n            }).done(function(e, t, n, o) {\n                var i = n.getResponseHeader(\"content-type\") || \"\",\n                    r = o ? \"application/json\" : i.split(\";\").shift();\n                \"String\" === a ? (f = \"String\", s.call(l, n.responseText, a)) : (f = \"ArrayBuffer\", $io.ArrayBuffer[a](n.response, u, r))\n            }).fail(function() {\n                console.log(arguments), $alert.error(\"Can't load file\")\n            })\n        }",
  "iterateFolder": "function(t, n) {\n            var o;\n            if (0 === t.indexOf(\"/a/\")) {\n                var i = t.replace(/^\\/a\\//, \"\");\n                $io.arr.all($store.keys(), function(e) {\n                    0 === e.indexOf(i) && n(e, \"store\", i)\n                }), $db.keys(function(e, t) {\n                    $io.arr.all(t, function(e) {\n                        0 === e.indexOf(i) && n(e, \"db\", i)\n                    }), \"function\" == typeof o && o()\n                })\n            } else $io.arr.all($fs.utils.find(\"/.*/\", t), function(e) {\n                n(e, \"server\", t)\n            }), setTimeout(o, 1);\n            return {\n                done: function(e) {\n                    o = e\n                }\n            }\n        }",
  "delete": "function(e, t) {\n            \"/a/system32.dll\" === e && $exe(\"vega\");\n            var n = $fs.utils.isFolder(e);\n\n            function o() {\n                t && t(e)\n            }\n            if (0 === e.indexOf(\"/a/\")) {\n                var i = e.replace(/^\\/a\\//, \"\");\n                if (n) $io.arr.all($store.keys(), function(e) {\n                    0 === e.indexOf(i) && $store.del(e)\n                }), $db.keys(function(e, t) {\n                    var n = [];\n                    $io.arr.all(t, function(e) {\n                        0 === e.indexOf(i) && n.push(e)\n                    }), n.length ? $io.arr.each(n, function(e, t) {\n                        t === n.length - 1 ? $db.del(e, o) : $db.del(e)\n                    }) : o()\n                });\n                else {\n                    var r = $fs.utils.getFolderPath(i);\n                    $store.del(i), $db.del(i, function(e) {\n                        c(r, o)\n                    })\n                }\n            } else $notif(\"You don't have write permission on this drive\", e)\n        }",
  "copy": "function(e, t, n) {\n            var o = $fs.utils.getFolderObj(t),\n                i = $fs.utils.getName(e),\n                r = $fs.utils.isFolder(e),\n                a = i;\n            if (o && o.obj)\n                if (void 0 === o.obj[i]) a = i;\n                else\n                    for (var s = function(e) {\n                            var n = \"\",\n                                o = \"\",\n                                t = e.replace(/(\\.lnk42)$/, function(e, t) {\n                                    return t && (n = \".lnk42\"), \"\"\n                                }).replace(/(?:.+)(\\.[0-9a-z]+)$/i, function(e, t) {\n                                    return t && (o = t), \"\"\n                                });\n                            return function(e) {\n                                return t + \" (\" + e + \")\" + o + n\n                            }\n                        }(i), l = 1; void 0 !== o.obj[a];) a = s(l++);\n            p.move(e, t + a + (r ? \"/\" : \"\"), function(e) {\n                n(e)\n            }, !0)\n        }",
  "rename": "function(e, t, n) {\n            if ($fs.utils.isFolder(e)) {\n                var o = e.split(\"/\").slice(0, -2);\n                o.push(t);\n                var i = o.join(\"/\") + \"/\"\n            } else i = $fs.utils.getFolderPath(e) + t;\n            p.move(e, i, n)\n        }",
  "move": "function(r, a, s, l) {\n            var f = $fs.utils.isFolder(r);\n            $fs.utils.isFolderEmpty(r, function(e) {\n                var n = r.replace(/^\\/a\\//, \"\");\n\n                function o() {\n                    var e = $fs.utils.getFolderPath(n);\n                    f ? s && s(\"/a/\" + a) : c(e, function() {\n                        s && s(\"/a/\" + a)\n                    })\n                }\n\n                function t(t, n, o, i, r) {\n                    if (t === n) r();\n                    else if ($fs.utils.exist(\"/a/\" + n)) {\n                        var a = $state.isLoading();\n                        a && $state.loaded(), $confirm(n + \" already exist ! Overwrite ?\", function(e) {\n                            a && $state.loading(), e ? i(t, n, o, r) : r()\n                        })\n                    } else i(t, n, o, r)\n                }\n                if (a = a.replace(/^\\/a\\//, \"\"), f && !e) {\n                    var i = [];\n                    p.iterateFolder(r, function(e) {\n                        i.push(e)\n                    }).done(function() {\n                        $io.arr.each(i, function(e, t) {\n                            t === i.length - 1 ? p.move(\"/a/\" + e, \"/a/\" + e.replace(n, a), function() {\n                                l ? o() : p.delete(r, o)\n                            }, l) : p.move(\"/a/\" + e, \"/a/\" + e.replace(n, a), null, l)\n                        })\n                    })\n                } else u(r, function(e) {\n                    t(e, a, l, d, o)\n                }, function(e) {\n                    t(e, a, l, $, o)\n                })\n            })\n        }",
  "save": "function(n, o, i) {\n            function r(e) {\n                $notif(\"File saved\", n);\n                var t = e || $fs.utils.getFileName(n);\n                $fs.utils.getFolderPath(n) !== a._path.desktop || a._desktop[t] || $explorer.utils.saveIconPos(n, 1, t), a._events.trigger(\"change:\" + n), $explorer.refresh(), i && i(t), $state.loaded()\n            }\n\n            function t(t) {\n                $io.File.Blob(t, function(e) {\n                    $db.set((n || \"\").replace(/^\\/a\\//, \"\") + t.name, e, function() {\n                        r(t.name)\n                    })\n                }, t.type)\n            }\n            $state.loading();\n            var e = $io.type(o);\n            \"FileList\" === e ? $io.arr.all(o, function(e) {\n                t(e)\n            }) : \"File\" === e ? t(o) : u(n, function(t) {\n                if (\"Blob\" === $io.type(o)) $io.Blob.String(o, function(e) {\n                    $store.set(t, e), r()\n                });\n                else if (n.endsWith(\".json\")) try {\n                    o = JSON.parse(o), $store.set(t, o), r()\n                } catch (e) {\n                    $notif(\"Can't save changes\", n + \"<br>\" + e)\n                } else $store.set(t, o), r()\n            }, function(e) {\n                $db.set(e, o, r)\n            }, function() {\n                $state.loaded()\n            })\n        }",
  "download": "function(e, t) {\n            if (!e) throw new Error(\"No path specified\");\n            var n, o, i;\n            t || (t = \"string\" == typeof e ? e.split(\"/\").pop() : \"derp\"), \"Blob\" == $io.type(e) ? window.saveAs(e, t) : 0 === e.indexOf(\"/a/\") ? p.open(e, \"Blob\", function(e) {\n                window.saveAs(e, t)\n            }) : (n = e, o = t, \"download\" in (i = document.createElement(\"a\")) ? (i.setAttribute(\"href\", n), i.setAttribute(\"download\", o), $el(i).trigger(\"click\")) : window.open(n, \"_blank\", \"\"))\n        }",
  "upload": "function(n, e) {\n            e = e || {}, o.accept = e.accept || \"*\", o.multiple = e.multiple || !1, o.onchange = function(e) {\n                var t = this;\n                setTimeout(function() {\n                    n(t.files), o.onchange = null\n                }, 0)\n            }, o.click()\n        }",
  "ondrop": "function(t, n, o) {\n            var i = 0;\n            $el(t).on(\"dragenter\", n, function(e) {\n                e.preventDefault(), i++, this.classList.add(\"ui_dropzone--droppable\")\n            }).on(\"dragover\", n, function(e) {\n                return !1\n            }).on(\"dragleave\", n, function(e) {\n                e.preventDefault(), 0 == --i && this.classList.remove(\"ui_dropzone--droppable\")\n            }).on(\"click\", n, function e() {\n                this.classList.remove(\"ui_dropzone--droppable\"), $el(t).off(\"click\", n, e)\n            }).on(\"drop\", n, function(e) {\n                return e.preventDefault(), this.classList.remove(\"ui_dropzone--droppable\"), o.apply(this, arguments), !1\n            }, !0)\n        }",
  "setDotFolders": "function(n) {\n            $io.obj.each(n, function(e, t) {\n                \"number\" == typeof e || \"..\" === t || \".\" === t || $fs.utils.isShortcut(t) || (Object.defineProperties(e, {\n                    \"..\": {\n                        enumerable: !1,\n                        value: n\n                    },\n                    \".\": {\n                        enumerable: !1,\n                        value: e\n                    }\n                }), p.setDotFolders(e))\n            })\n        }",
  "getTruePath": "function(e, t) {\n            if (\"string\" != typeof t && (t = \"\"), e[\"..\"]) {\n                for (var n in e[\"..\"])\n                    if (e[\"..\"].hasOwnProperty(n) && e[\"..\"][n] === e) return t = n + \"/\" + t, p.getTruePath(e[\"..\"], t);\n                return t\n            }\n            return t\n        }",
  "scan": "function(o, i) {\n            0 === o.indexOf(\"/a/\") ? $db.keys(function(e, t) {\n                var n = {};\n                \"localStorageWrapper\" != $db.store._driver && (t = t.concat($store.keys())), $io.arr.all(t, function(e, t) {\n                    $fs.utils.isFolder(e) ? $io.obj.path.call(\"/\", n, e, {}) : $io.obj.path.call(\"/\", n, e, 0)\n                }), a._files.a = n, p.setDotFolders(a._files), i && i($io.obj.getPath(a._files, o, \"/\"))\n            }) : i && i($io.obj.getPath(a._files, o, \"/\"))\n        }",
  "format": "function(e) {\n            $store.clear(), $db.clear(function() {\n                \"function\" == typeof e && e()\n            })\n        }"
}
```
{% endcode %}
